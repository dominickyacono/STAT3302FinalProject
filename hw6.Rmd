---
title: "STAT3302 HW 6"
author: "Dominick Yacono.5"
date: "2024-04-12"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
#importing libraries
library(alr4)
library(tidyverse)
library(broom)
library(ggplot2)
library(knitr)

```

### Question 12.8
The Data:
```{R}
kable(round(blood_glucose, 2))
```
Part (a):

PCA With S
```{R}
pca.fit.S <- prcomp(blood_glucose, scale.= FALSE)
kable(round(pca.fit.S$rotation, 2))
```



PCA With R
```{R}
pca.fit.R <- prcomp(blood_glucose, scale.= TRUE)
kable(round(pca.fit.R$rotation, 2))
```

Part (b):
Which do you think is more appropriate?

```{R}
kable(diag(round(cov(pca.fit.R), 2)), col.names=c("Variance"))


```

We can see a large range of variance values when doing PCA with S. The variables for fasting have variance around the 70s, while the variables for 1 hour after sugar intake have variances above 500. Therefore, doing PCA with R might be more appropriate. Using the correlation matrix, the values from PCA are closer and more uniform.

Part (c):

```{R}
summary(pca.fit.R)
```

PC1's proportion of total variance: .3628/1
PC2's proportion of total vairance: .1799/1
PC3's proportion of total variance: .1630/1
PC4's proportion of total variance: .1443/1
PC5's proportion of total variance: .09195/1
PC6's proportion of total variance: .05805/1

Part (d):
```{R}
par(mfrow=c(1,1), cex=0.5, mar=c(3.1,3.1,1,0.5),mgp=c(1.8,0.5,0), bty="L")
plot(pca.fit.R, type="l", main="Scree Plot")
```


